{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 425,
   "id": "44a1bb8a-82eb-4e9f-9ca8-aca147847e4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 426,
   "id": "ee400280-a474-4a84-b945-6ba5a455227f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('jobOffers.csv', index_col=0, skipinitialspace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 427,
   "id": "0024a3f3-ae8a-4470-9f1a-e794b7ccf8b0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>jobTitles</th>\n",
       "      <th>company</th>\n",
       "      <th>salaryRange</th>\n",
       "      <th>Bonus</th>\n",
       "      <th>category+progLang</th>\n",
       "      <th>seniority</th>\n",
       "      <th>workLanguage</th>\n",
       "      <th>location</th>\n",
       "      <th>remote</th>\n",
       "      <th>salLower</th>\n",
       "      <th>salUpper</th>\n",
       "      <th>salAvg</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Java Software Developer</td>\n",
       "      <td>Intempt Technologies</td>\n",
       "      <td>23.2k  - 34.9k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Backend, java</td>\n",
       "      <td>Junior</td>\n",
       "      <td>Work language:angličtina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>23200</td>\n",
       "      <td>34900</td>\n",
       "      <td>29050.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>C++ Developer</td>\n",
       "      <td>Sourcein</td>\n",
       "      <td>70k  - 140k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Backend, C#</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:česky</td>\n",
       "      <td>Prague, Altajská 1568/4 (Po pandemi)• Prague,...</td>\n",
       "      <td>Covid-time na dálku</td>\n",
       "      <td>70000</td>\n",
       "      <td>140000</td>\n",
       "      <td>105000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>C# Developer</td>\n",
       "      <td>Sourcein</td>\n",
       "      <td>70k  - 140k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Backend, C#</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:česky</td>\n",
       "      <td>Prague, Altajská 1568/4 (Po pandemi)• Prague,...</td>\n",
       "      <td>Covid-time na dálku</td>\n",
       "      <td>70000</td>\n",
       "      <td>140000</td>\n",
       "      <td>105000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Java developer u Medvědů</td>\n",
       "      <td>Coding Bear</td>\n",
       "      <td>60k  - 120k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Backend, java</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:česky</td>\n",
       "      <td>Praha, Vítkova 241/10 • Praha, Vítkova 241/10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60000</td>\n",
       "      <td>120000</td>\n",
       "      <td>90000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Senior Backend Developer</td>\n",
       "      <td>DX Heroes</td>\n",
       "      <td>60k  - 100k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Backend, node</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:česky, angličtina</td>\n",
       "      <td>Praha, Rohanské nábř. 19 • Remote• Praha, Roh...</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>60000</td>\n",
       "      <td>100000</td>\n",
       "      <td>80000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>712</th>\n",
       "      <td>Remote Database Administrator</td>\n",
       "      <td>MeWe</td>\n",
       "      <td>139.7k  - 186.3k  CZK</td>\n",
       "      <td>+5%</td>\n",
       "      <td>DevOps, kubernetes</td>\n",
       "      <td>Senior, Expert</td>\n",
       "      <td>Work language:angličtina</td>\n",
       "      <td>Los Angeles • Remote• Los Angeles</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>139700</td>\n",
       "      <td>186300</td>\n",
       "      <td>163000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>713</th>\n",
       "      <td>Senior DevOps Engineer</td>\n",
       "      <td>Hitachi ABB Power Grids</td>\n",
       "      <td>73.1k  - 104.4k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DevOps, PowerShell</td>\n",
       "      <td>Senior, Expert</td>\n",
       "      <td>Work language:angličtina, polsky</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>73100</td>\n",
       "      <td>104400</td>\n",
       "      <td>88750.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>714</th>\n",
       "      <td>DevOps Engineer</td>\n",
       "      <td>Storypoint</td>\n",
       "      <td>139.7k  - 186.3k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DevOps, python</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:ukrajinsky, angličtina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>139700</td>\n",
       "      <td>186300</td>\n",
       "      <td>163000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>715</th>\n",
       "      <td>DevOps Engineer</td>\n",
       "      <td>Appliscale Sp. z o.o.</td>\n",
       "      <td>75.7k  - 151.4k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DevOps, ansible</td>\n",
       "      <td>Mid, Senior</td>\n",
       "      <td>Work language:angličtina</td>\n",
       "      <td>krakow, Życzkowskiego 14 • Remote• krakow, Ży...</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>75700</td>\n",
       "      <td>151400</td>\n",
       "      <td>113550.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>716</th>\n",
       "      <td>DevOps Engineer</td>\n",
       "      <td>Bidroom</td>\n",
       "      <td>73.1k  - 120.1k  CZK</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DevOps, aws</td>\n",
       "      <td>Mid</td>\n",
       "      <td>Work language:angličtina</td>\n",
       "      <td>Kraków, Prague, Bratislava • Remote• Kraków, ...</td>\n",
       "      <td>Na dálku</td>\n",
       "      <td>73100</td>\n",
       "      <td>120100</td>\n",
       "      <td>96600.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>716 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                          jobTitles                   company  \\\n",
       "0          Java Software Developer      Intempt Technologies    \n",
       "1                    C++ Developer                  Sourcein    \n",
       "2                     C# Developer                  Sourcein    \n",
       "3         Java developer u Medvědů               Coding Bear    \n",
       "4         Senior Backend Developer                 DX Heroes    \n",
       "..                              ...                       ...   \n",
       "712  Remote Database Administrator                      MeWe    \n",
       "713         Senior DevOps Engineer   Hitachi ABB Power Grids    \n",
       "714                DevOps Engineer                Storypoint    \n",
       "715                DevOps Engineer     Appliscale Sp. z o.o.    \n",
       "716                DevOps Engineer                   Bidroom    \n",
       "\n",
       "                salaryRange Bonus   category+progLang         seniority  \\\n",
       "0      23.2k  - 34.9k  CZK    NaN       Backend, java           Junior    \n",
       "1         70k  - 140k  CZK    NaN         Backend, C#      Mid, Senior    \n",
       "2         70k  - 140k  CZK    NaN         Backend, C#      Mid, Senior    \n",
       "3         60k  - 120k  CZK    NaN       Backend, java      Mid, Senior    \n",
       "4         60k  - 100k  CZK    NaN       Backend, node      Mid, Senior    \n",
       "..                      ...   ...                 ...               ...   \n",
       "712  139.7k  - 186.3k  CZK   +5%   DevOps, kubernetes   Senior, Expert    \n",
       "713   73.1k  - 104.4k  CZK    NaN  DevOps, PowerShell   Senior, Expert    \n",
       "714  139.7k  - 186.3k  CZK    NaN      DevOps, python      Mid, Senior    \n",
       "715   75.7k  - 151.4k  CZK    NaN     DevOps, ansible      Mid, Senior    \n",
       "716   73.1k  - 120.1k  CZK    NaN         DevOps, aws              Mid    \n",
       "\n",
       "                             workLanguage  \\\n",
       "0                Work language:angličtina   \n",
       "1                     Work language:česky   \n",
       "2                     Work language:česky   \n",
       "3                     Work language:česky   \n",
       "4         Work language:česky, angličtina   \n",
       "..                                    ...   \n",
       "712              Work language:angličtina   \n",
       "713      Work language:angličtina, polsky   \n",
       "714  Work language:ukrajinsky, angličtina   \n",
       "715              Work language:angličtina   \n",
       "716              Work language:angličtina   \n",
       "\n",
       "                                              location                remote  \\\n",
       "0                                                  NaN             Na dálku    \n",
       "1     Prague, Altajská 1568/4 (Po pandemi)• Prague,...  Covid-time na dálku    \n",
       "2     Prague, Altajská 1568/4 (Po pandemi)• Prague,...  Covid-time na dálku    \n",
       "3       Praha, Vítkova 241/10 • Praha, Vítkova 241/10                    NaN   \n",
       "4     Praha, Rohanské nábř. 19 • Remote• Praha, Roh...             Na dálku    \n",
       "..                                                 ...                   ...   \n",
       "712                 Los Angeles • Remote• Los Angeles              Na dálku    \n",
       "713                                                NaN             Na dálku    \n",
       "714                                                NaN             Na dálku    \n",
       "715   krakow, Życzkowskiego 14 • Remote• krakow, Ży...             Na dálku    \n",
       "716   Kraków, Prague, Bratislava • Remote• Kraków, ...             Na dálku    \n",
       "\n",
       "     salLower  salUpper    salAvg  \n",
       "0       23200     34900   29050.0  \n",
       "1       70000    140000  105000.0  \n",
       "2       70000    140000  105000.0  \n",
       "3       60000    120000   90000.0  \n",
       "4       60000    100000   80000.0  \n",
       "..        ...       ...       ...  \n",
       "712    139700    186300  163000.0  \n",
       "713     73100    104400   88750.0  \n",
       "714    139700    186300  163000.0  \n",
       "715     75700    151400  113550.0  \n",
       "716     73100    120100   96600.0  \n",
       "\n",
       "[716 rows x 12 columns]"
      ]
     },
     "execution_count": 427,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#salary\n",
    "df = df.drop(df[df['salaryRange'] == 'neplacená stáž'].index)\n",
    "df['salLower'] = df['salaryRange'].str.split(\" - \").str[0].str.split(\"  \").str[0]\n",
    "df['salUpper'] = df['salaryRange'].str.split(\" - \").str[1].str.split(\"  \").str[0]\n",
    "\n",
    "df['salLower'] = df['salLower'].replace({'k': '*1e3'}, regex=True).map(pd.eval).astype(int)\n",
    "df['salUpper'].fillna(df['salLower'], inplace = True)\n",
    "df['salUpper'] = df['salUpper'].replace({'k': '*1e3'}, regex=True).map(pd.eval).astype(int)\n",
    "\n",
    "df['salAvg'] = (df['salUpper'] + df['salLower'])/2\n",
    "\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 428,
   "id": "b097f546-b89d-42a1-951f-cb9bed1f9e24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#category and main programming language\n",
    "df['category'] = df['category+progLang'].str.split(\", \").str[0]\n",
    "df['mainProgLang'] = df['category+progLang'].str.split(\", \").str[1]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 429,
   "id": "1bcd1286-3b8c-4592-981f-f75a3c2aa1c1",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "#seniority\n",
    "df[\"seniority\"] = df[\"seniority\"].str.strip().replace({'Trainee, Junior': 'Junior', 'Trainee': 'Junior',\n",
    "                                                          'Senior, Expert':'Senior',\n",
    "                                                          'Expert':'Senior', 'Mid, Senior':'Mid Advanced'})\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 430,
   "id": "69839913",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Work language\n",
    "df[\"workLanguage\"]=df[\"workLanguage\"].str.replace(\"Work language:\",\"\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0a9fe1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#getting rid of the numbers, dots and converting to lowercase to standardise prog langugage\n",
    "df_final.loc[:,\"mainProgLang\"] = df_final.loc[:,\"mainProgLang\"].str.replace('\\d+', '')\n",
    "df_final.loc[:,\"mainProgLang\"] = df_final.loc[:,\"mainProgLang\"].str.replace('.', '')\n",
    "df[\"mainProgLang\"]=df[\"mainProgLang\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 431,
   "id": "d0dcb892",
   "metadata": {},
   "outputs": [],
   "source": [
    "#leaving just first adress in location for simplification\n",
    "df[\"location\"]=df[\"location\"].str.split(\",\").str[0]\n",
    "df[\"location\"]=df[\"location\"].str.split(\"•\").str[0]\n",
    "#adjusting remote with location -- Where is Na dálku in remote => location: Remote, \n",
    "#when remote: Nan or Covid-time na dálku => location: first city witout street adress\n",
    "df.loc[df.remote == \"Na dálku \",\"location\"]= \"Remote\"\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 432,
   "id": "2393a11a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>jobTitles</th>\n",
       "      <th>company</th>\n",
       "      <th>Bonus</th>\n",
       "      <th>seniority</th>\n",
       "      <th>workLanguage</th>\n",
       "      <th>location</th>\n",
       "      <th>salAvg</th>\n",
       "      <th>category</th>\n",
       "      <th>mainProgLang</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Java Software Developer</td>\n",
       "      <td>Intempt Technologies</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Junior</td>\n",
       "      <td>angličtina</td>\n",
       "      <td>Remote</td>\n",
       "      <td>29050.0</td>\n",
       "      <td>Backend</td>\n",
       "      <td>java</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>C++ Developer</td>\n",
       "      <td>Sourcein</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mid Advanced</td>\n",
       "      <td>česky</td>\n",
       "      <td>Prague</td>\n",
       "      <td>105000.0</td>\n",
       "      <td>Backend</td>\n",
       "      <td>c#</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>C# Developer</td>\n",
       "      <td>Sourcein</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mid Advanced</td>\n",
       "      <td>česky</td>\n",
       "      <td>Prague</td>\n",
       "      <td>105000.0</td>\n",
       "      <td>Backend</td>\n",
       "      <td>c#</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Java developer u Medvědů</td>\n",
       "      <td>Coding Bear</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mid Advanced</td>\n",
       "      <td>česky</td>\n",
       "      <td>Praha</td>\n",
       "      <td>90000.0</td>\n",
       "      <td>Backend</td>\n",
       "      <td>java</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Senior Backend Developer</td>\n",
       "      <td>DX Heroes</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mid Advanced</td>\n",
       "      <td>česky, angličtina</td>\n",
       "      <td>Remote</td>\n",
       "      <td>80000.0</td>\n",
       "      <td>Backend</td>\n",
       "      <td>node</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   jobTitles                company Bonus     seniority  \\\n",
       "0   Java Software Developer   Intempt Technologies    NaN        Junior   \n",
       "1             C++ Developer               Sourcein    NaN  Mid Advanced   \n",
       "2              C# Developer               Sourcein    NaN  Mid Advanced   \n",
       "3  Java developer u Medvědů            Coding Bear    NaN  Mid Advanced   \n",
       "4  Senior Backend Developer              DX Heroes    NaN  Mid Advanced   \n",
       "\n",
       "        workLanguage location    salAvg category mainProgLang  \n",
       "0         angličtina   Remote   29050.0  Backend         java  \n",
       "1              česky   Prague  105000.0  Backend           c#  \n",
       "2              česky   Prague  105000.0  Backend           c#  \n",
       "3              česky    Praha   90000.0  Backend         java  \n",
       "4  česky, angličtina   Remote   80000.0  Backend         node  "
      ]
     },
     "execution_count": 432,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#subseting dataset\n",
    "df_final=df[['jobTitles', 'company', 'Bonus','seniority', 'workLanguage', 'location','salAvg', 'category',\n",
    "       'mainProgLang']]\n",
    "df_final.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 433,
   "id": "253e717b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Bonus\n",
       "+1%           1\n",
       "+10%         25\n",
       "+12%          1\n",
       "+13%          1\n",
       "+15%          6\n",
       "+2%           1\n",
       "+20%          2\n",
       "+25%          1\n",
       "+30%          2\n",
       "+5%           5\n",
       "+50%          4\n",
       "+7%           1\n",
       "10000 PLN     1\n",
       "20k CZK       1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 433,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#do we keep bonus? (and jobTitles and company?)\n",
    "df_final.groupby(\"Bonus\").size()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 449,
   "id": "11a38abe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#making sure there are no whitespaces left\n",
    "df_final.columns = df_final.columns.str.strip()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 453,
   "id": "fdd43f1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#to CSV\n",
    "df_final.to_csv(\"cleaned_Ivan.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d4be2cb5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
